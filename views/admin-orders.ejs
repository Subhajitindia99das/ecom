<%- include('./partials/header') %>

<h2>All Orders</h2>

<% orders.forEach(order => { %>
    <div style="border:1px solid #ccc; padding:10px; margin:10px 0;">

        <p>User: <%= order.user.email %></p>
        <p>Total: ₹ <%= order.totalAmount %></p>
        <p>Status: <%= order.status %></p>

        <p>Products:</p>
        <ul>
            <% order.products.forEach(p => { %>
                <li><%= p.name %> — ₹ <%= p.price %></li>
            <% }) %>
        </ul>

        <!-- ✅ STATUS UPDATE FORM (INSIDE LOOP) -->
        <form action="/owners/orders/<%= order._id %>/status" method="post">
            <select name="status">
                <option value="Pending" <%= order.status === "Pending" ? "selected" : "" %>>Pending</option>
                <option value="Completed" <%= order.status === "Completed" ? "selected" : "" %>>Completed</option>
                <option value="Cancelled" <%= order.status === "Cancelled" ? "selected" : "" %>>Cancelled</option>
            </select>
            <button type="submit">Update</button>
        </form>

    </div>
<% }) %>

<%- include('./partials/footer') %>
