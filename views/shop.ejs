<%- include('./partials/header') %>

<div class="w-full min-h-screen
            px-4 md:px-20
            py-6
            flex flex-col md:flex-row
            gap-10">

    <!-- ================= SIDEBAR ================= -->
    <aside
      class="w-full md:w-[22%]
             flex flex-col gap-8
             text-sm
             text-black dark:text-white">

        <!-- Sort -->
        <div class="flex items-center gap-3">
            <span class="opacity-70">Sort by</span>
            <form action="/shop">
                <select
                  class="bg-white/80 dark:bg-white/10
                         border border-black/10 dark:border-white/20
                         rounded-md px-3 py-1
                         text-black dark:text-white">
                    <option>Popular</option>
                    <option>Newest</option>
                </select>
            </form>
        </div>

        <!-- Collections -->
        <div class="flex flex-col gap-2">
            <span class="opacity-60">Collections</span>
            <a class="hover:opacity-80" href="#">New Collection</a>
            <a class="hover:opacity-80" href="#">All Products</a>
            <a class="hover:opacity-80" href="#">Discounted</a>
        </div>

        <!-- Filters -->
        <div class="flex flex-col gap-2">
            <span class="opacity-60">Filter by</span>
            <a class="hover:opacity-80" href="#">Availability</a>
            <a class="hover:opacity-80" href="#">Discount</a>
        </div>
    </aside>

    <!-- ================= PRODUCTS ================= -->
    <section class="w-full md:w-[78%]">

        <div
          class="grid grid-cols-1
                 sm:grid-cols-2
                 lg:grid-cols-3
                 xl:grid-cols-4
                 gap-6">

            <% products.forEach(product => { %>

            <!-- Product Card -->
            <div
              class="rounded-2xl overflow-hidden
                     bg-white/80 dark:bg-white/5
                     backdrop-blur-xl
                     border border-black/10 dark:border-white/10
                     shadow-lg
                     transition hover:scale-[1.02]">

                <!-- Image -->
                <div
                  class="h-52 flex items-center justify-center"
                  style="background:<%= product.bgcolor %>">
                    <img
                      class="h-40 object-contain"
                      src="data:image/jpeg;base64,<%= product.image.toString('base64') %>"
                      alt="<%= product.name %>">
                </div>

                <!-- Info -->
                <div
                  class="flex items-center justify-between
                         px-4 py-4"
                  style="background:<%= product.panelcolor %>;
                         color:<%= product.textcolor %>">

                    <div>
                        <h3 class="font-medium">
                            <%= product.name %>
                        </h3>
                        <p class="text-sm">
                            â‚¹ <%= product.price %>
                        </p>
                    </div>

                    <% if (user && user.role === "user") { %>
                    <form action="/addtocart/<%= product._id %>" method="post">
                        <button
                          class="w-9 h-9 rounded-full
                                 bg-white text-black
                                 flex items-center justify-center
                                 shadow-md">
                            <i class="ri-add-line"></i>
                        </button>
                    </form>
                    <% } %>

                </div>
            </div>

            <% }) %>
        </div>
    </section>
</div>

<%- include('./partials/footer') %>
