<%- include('./partials/header') %>

<div class="w-full min-h-screen flex px-20 py-20 gap-10">

    <!-- CART ITEMS -->
    <div class="w-[60%]">
        <h2 class="text-xl mb-4">My Cart</h2>

        <% if (user.cart.length === 0) { %>
            <p>Your cart is empty</p>
        <% } %>

        <% user.cart.forEach(product => { %>
            <div class="flex gap-5 border p-4 mb-4 items-center">

                <% if (product.image) { %>
                    <img
                        class="h-32"
                        src="data:image/jpeg;base64,<%= product.image.toString('base64') %>"
                    />
                <% } %>

                <div class="flex-1">
                    <h3 class="text-lg"><%= product.name %></h3>
                    <p>₹ <%= product.price %></p>

                    <form action="/removefromcart/<%= product._id %>" method="post">
                        <button class="text-red-600 mt-2">Remove</button>
                    </form>
                </div>
            </div>
        <% }) %>
    </div>

    <!-- PRICE SUMMARY -->
    <div class="w-[40%] border p-6 h-fit">
        <h3 class="text-lg mb-4">Price Details</h3>

        <div class="flex justify-between">
            <span>Total</span>
            <span>₹ <%= total %></span>
        </div>

        <div class="flex justify-between mt-2">
            <span>Platform Fee</span>
            <span>₹ 20</span>
        </div>

        <hr class="my-4">

        <div class="flex justify-between font-semibold text-green-600">
            <span>Total Amount</span>
            <span>₹ <%= total + 20 %></span>
        </div>
        <% if (user.cart.length > 0) { %>
            <form action="/placeorder" method="post" class="mt-6">
                <button class="w-full bg-black text-white py-3 rounded">
                    Place Order
                </button>
            </form>
        <% } %>

    </div>

</div>

<%- include('./partials/footer') %>
